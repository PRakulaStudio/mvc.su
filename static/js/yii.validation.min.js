yii.validation=function(e){function a(a,s,t){if("undefined"==typeof File)return[];var n=e(a.input,a.$form).get(0).files;return n?0===n.length?(t.skipOnEmpty||s.push(t.uploadRequired),[]):t.maxFiles&&t.maxFiles<n.length?(s.push(t.tooMany),[]):n:(s.push(t.message),[])}function s(e,a,s){if(s.extensions&&s.extensions.length>0){var n=e.name.lastIndexOf("."),i=~n?e.name.substr(n+1,e.name.length).toLowerCase():"";~s.extensions.indexOf(i)||a.push(s.wrongExtension.replace(/\{file\}/g,e.name))}s.mimeTypes&&s.mimeTypes.length>0&&(t(s.mimeTypes,e.type)||a.push(s.wrongMimeType.replace(/\{file\}/g,e.name))),s.maxSize&&s.maxSize<e.size&&a.push(s.tooBig.replace(/\{file\}/g,e.name)),s.minSize&&s.minSize>e.size&&a.push(s.tooSmall.replace(/\{file\}/g,e.name))}function t(e,a){for(var s=0,t=e.length;s<t;s++)if(new RegExp(e[s]).test(a))return!0;return!1}function n(e,a,s,t){t.minWidth&&a.width<t.minWidth&&s.push(t.underWidth.replace(/\{file\}/g,e.name)),t.maxWidth&&a.width>t.maxWidth&&s.push(t.overWidth.replace(/\{file\}/g,e.name)),t.minHeight&&a.height<t.minHeight&&s.push(t.underHeight.replace(/\{file\}/g,e.name)),t.maxHeight&&a.height>t.maxHeight&&s.push(t.overHeight.replace(/\{file\}/g,e.name))}var i={isEmpty:function(a){return null===a||void 0===a||e.isArray(a)&&0===a.length||""===a},addMessage:function(e,a,s){e.push(a.replace(/\{value\}/g,s))},required:function(a,s,t){var n=!1;if(void 0===t.requiredValue){var r="string"==typeof a||a instanceof String;(t.strict&&void 0!==a||!t.strict&&!i.isEmpty(r?e.trim(a):a))&&(n=!0)}else(!t.strict&&a==t.requiredValue||t.strict&&a===t.requiredValue)&&(n=!0);n||i.addMessage(s,t.message,a)},boolean:function(e,a,s){s.skipOnEmpty&&i.isEmpty(e)||!s.strict&&(e==s.trueValue||e==s.falseValue)||s.strict&&(e===s.trueValue||e===s.falseValue)||i.addMessage(a,s.message,e)},string:function(e,a,s){s.skipOnEmpty&&i.isEmpty(e)||("string"==typeof e?void 0===s.is||e.length==s.is?(void 0!==s.min&&e.length<s.min&&i.addMessage(a,s.tooShort,e),void 0!==s.max&&e.length>s.max&&i.addMessage(a,s.tooLong,e)):i.addMessage(a,s.notEqual,e):i.addMessage(a,s.message,e))},file:function(t,n,i){var r=a(t,n,i);e.each(r,function(e,a){s(a,n,i)})},image:function(t,n,r,o){var l=a(t,n,r);e.each(l,function(a,t){if(s(t,n,r),"undefined"!=typeof FileReader){var l=e.Deferred();i.validateImage(t,n,r,l,new FileReader,new Image),o.push(l)}})},validateImage:function(e,a,s,t,i,r){r.onload=function(){n(e,r,a,s),t.resolve()},r.onerror=function(){a.push(s.notImage.replace(/\{file\}/g,e.name)),t.resolve()},i.onload=function(){r.src=this.result},i.onerror=function(){t.resolve()},i.readAsDataURL(e)},number:function(e,a,s){s.skipOnEmpty&&i.isEmpty(e)||("string"!=typeof e||s.pattern.test(e)?(void 0!==s.min&&e<s.min&&i.addMessage(a,s.tooSmall,e),void 0!==s.max&&e>s.max&&i.addMessage(a,s.tooBig,e)):i.addMessage(a,s.message,e))},range:function(a,s,t){if(!t.skipOnEmpty||!i.isEmpty(a))if(t.allowArray||!e.isArray(a)){var n=!0;e.each(e.isArray(a)?a:[a],function(a,s){return-1!=e.inArray(s,t.range)||(n=!1,!1)}),void 0===t.not&&(t.not=!1),t.not===n&&i.addMessage(s,t.message,a)}else i.addMessage(s,t.message,a)},regularExpression:function(e,a,s){s.skipOnEmpty&&i.isEmpty(e)||(!s.not&&!s.pattern.test(e)||s.not&&s.pattern.test(e))&&i.addMessage(a,s.message,e)},email:function(e,a,s){if(!s.skipOnEmpty||!i.isEmpty(e)){var t=!0,n=/^((?:"?([^"]*)"?\s)?)(?:\s+)?(?:(<?)((.+)@([^>]+))(>?))$/.exec(e);if(null===n)t=!1;else{var r=n[5],o=n[6];s.enableIDN&&(r=punycode.toASCII(r),o=punycode.toASCII(o),e=n[1]+n[3]+r+"@"+o+n[7]),t=!(r.length>64)&&(!((r+"@"+o).length>254)&&(s.pattern.test(e)||s.allowName&&s.fullPattern.test(e)))}t||i.addMessage(a,s.message,e)}},url:function(e,a,s){if(!s.skipOnEmpty||!i.isEmpty(e)){s.defaultScheme&&!/:\/\//.test(e)&&(e=s.defaultScheme+"://"+e);var t=!0;if(s.enableIDN){var n=/^([^:]+):\/\/([^\/]+)(.*)$/.exec(e);null===n?t=!1:e=n[1]+"://"+punycode.toASCII(n[2])+n[3]}t&&s.pattern.test(e)||i.addMessage(a,s.message,e)}},trim:function(a,s,t){var n=a.find(s.input),r=n.val();return t.skipOnEmpty&&i.isEmpty(r)||(r=e.trim(r),n.val(r)),r},captcha:function(a,s,t){if(!t.skipOnEmpty||!i.isEmpty(a)){var n=e("body").data(t.hashKey);n=null==n?t.hash:n[t.caseSensitive?0:1];for(var r=t.caseSensitive?a:a.toLowerCase(),o=r.length-1,l=0;o>=0;--o)l+=r.charCodeAt(o);l!=n&&i.addMessage(s,t.message,a)}},compare:function(a,s,t){if(!t.skipOnEmpty||!i.isEmpty(a)){var n,r=!0;switch(n=void 0===t.compareAttribute?t.compareValue:e("#"+t.compareAttribute).val(),"number"===t.type&&(a=parseFloat(a),n=parseFloat(n)),t.operator){case"==":r=a==n;break;case"===":r=a===n;break;case"!=":r=a!=n;break;case"!==":r=a!==n;break;case">":r=a>n;break;case">=":r=a>=n;break;case"<":r=a<n;break;case"<=":r=a<=n;break;default:r=!1}r||i.addMessage(s,t.message,a)}},ip:function(e,a,s){if(!s.skipOnEmpty||!i.isEmpty(e)){var t=null,n=null,r=new RegExp(s.ipParsePattern).exec(e);r&&(t=r[1]||null,e=r[2],n=r[4]||null),!0!==s.subnet||null!==n?!1!==s.subnet||null===n?!1!==s.negation||null===t?6==(-1===e.indexOf(":")?4:6)?(new RegExp(s.ipv6Pattern).test(e)||i.addMessage(a,s.messages.message,e),s.ipv6||i.addMessage(a,s.messages.ipv6NotAllowed,e)):(new RegExp(s.ipv4Pattern).test(e)||i.addMessage(a,s.messages.message,e),s.ipv4||i.addMessage(a,s.messages.ipv4NotAllowed,e)):i.addMessage(a,s.messages.message,e):i.addMessage(a,s.messages.hasSubnet,e):i.addMessage(a,s.messages.noSubnet,e)}}};return i}(jQuery);